<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="googlea8ba7e863392b1ab" />













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Android,源码,Google,Github,Framework,SDK限制," />





  <link rel="alternate" href="/atom.xml" title="Scott's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="引言作为一名Android 开发人员，很有必要阅读Android源码，平时在编译器如AndroidStudio或IntelliJ中，只要是创建Android项目工程，就能够查看到Framework层的源码，但是这样看源码有两个弊端： 1.容易处在一种盲人摸象的状态，只能看到局部，不能总览全局；2.看到的Framework层源码跟编译时使用的版本号相关，如果版本号很低，想看到最新的Android源码">
<meta name="keywords" content="Android,源码,Google,Github,Framework,SDK限制">
<meta property="og:type" content="article">
<meta property="og:title" content="如何下载并查看Android源码">
<meta property="og:url" content="http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html">
<meta property="og:site_name" content="Scott&#39;s Blog">
<meta property="og:description" content="引言作为一名Android 开发人员，很有必要阅读Android源码，平时在编译器如AndroidStudio或IntelliJ中，只要是创建Android项目工程，就能够查看到Framework层的源码，但是这样看源码有两个弊端： 1.容易处在一种盲人摸象的状态，只能看到局部，不能总览全局；2.看到的Framework层源码跟编译时使用的版本号相关，如果版本号很低，想看到最新的Android源码">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180703153058913695268.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180703153059903252234.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068451557786.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068772575884.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068856974079.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068870646902.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068884216372.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068894421498.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068898237535.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068900113818.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068850714232.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068953579156.png">
<meta property="og:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068964449010.png">
<meta property="og:updated_time" content="2018-07-04T07:40:53.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="如何下载并查看Android源码">
<meta name="twitter:description" content="引言作为一名Android 开发人员，很有必要阅读Android源码，平时在编译器如AndroidStudio或IntelliJ中，只要是创建Android项目工程，就能够查看到Framework层的源码，但是这样看源码有两个弊端： 1.容易处在一种盲人摸象的状态，只能看到局部，不能总览全局；2.看到的Framework层源码跟编译时使用的版本号相关，如果版本号很低，想看到最新的Android源码">
<meta name="twitter:image" content="http://7u2np3.com1.z0.glb.clouddn.com/20180703153058913695268.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"always","offset":12,"offset_float":0,"b2t":true,"scrollpercent":true},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html"/>





  <title>如何下载并查看Android源码 | Scott's Blog</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?760edc77a59a2329550e2d68c6400d9b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>
    
    <!-- 在右上角或者左上角实现fork me on github -->
    <a href="https://github.com/sguotao" class="github-corner" aria-label="View source on Github"><svg width="92" height="92" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Scott's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">和光同尘,静水流深</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Scott">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Scott's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">如何下载并查看Android源码</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-03T10:55:25+08:00">
                2018-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Android进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/Android进阶-2018-07-03-如何下载并查看Android源码.html" class="leancloud_visitors" data-flag-title="如何下载并查看Android源码">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  1,325字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  5分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>作为一名Android 开发人员，很有必要阅读Android源码，平时在编译器如AndroidStudio或IntelliJ中，只要是创建Android项目工程，就能够查看到Framework层的源码，但是这样看源码有两个弊端：</p>
<p>1.容易处在一种盲人摸象的状态，只能看到局部，不能总览全局；<br>2.看到的Framework层源码跟编译时使用的版本号相关，如果版本号很低，想看到最新的Android源码就十分的不方便。</p>
<p>还有一个很重要的原因，Google在Android P版本中，对非SDK接口进行了限制，什么意思？Google建议使用官方提供的SDK接口，对一些私有的API，Google是限制，甚至是禁止使用的。</p>
<h2 id="Android-P中SDK接口限制"><a href="#Android-P中SDK接口限制" class="headerlink" title="Android P中SDK接口限制"></a>Android P中SDK接口限制</h2><p>Google在最新的Android P版本中，对SDK接口的使用进行了严格的限制，这样的限制必将会对Android 应用的开发者带了影响，Google限制通过反射，JNI等方式调用非SDK接口，如果调用这些接口势必会带来兼容性问题，甚至会出现Crash。为了降低影响的程度，有必要了解一下SDK接口限制。</p>
<h3 id="什么是SDK接口"><a href="#什么是SDK接口" class="headerlink" title="什么是SDK接口"></a>什么是SDK接口</h3><p>凡是能够在<a href="https://developer.android.google.cn/reference/packages" target="_blank" rel="noopener">Google官网上查到的接口</a>，都是SDK接口，这些API是可以直接使用的。除了上面提到的接口，剩下的接口都是限制使用的。</p>
<h3 id="继续使用非SDK接口会有哪些影响"><a href="#继续使用非SDK接口会有哪些影响" class="headerlink" title="继续使用非SDK接口会有哪些影响"></a>继续使用非SDK接口会有哪些影响</h3><p>Google对非SDK接口提供了灰名单机制，将目前Android应用或定制OS调用的非SDK接口分进行了分级，分别为浅灰名单，深灰名单和黑名单。不同名单中的接口有不同的处理策略。</p>
<ol>
<li>浅灰名单，Google目前还没有可替代的SDK接口，暂时放在浅灰名单中。在Android P预览版上调用时会出现警告。</li>
<li>深灰名单，Google目前已经提供了可替代的SDK接口，开发者需要进行整改。这部分接口在Android P以下设备调用时出现警告，Android P及以上设备调用时出现Crash。</li>
<li>黑名单，浅灰名单和深灰名单之外的非SDK接口，都放在了这个名单中，这部分接口调用就会出现Crash。</li>
</ol>
<p>Google也提供了一个过渡期，这个过渡期是随着Android P版本同步的，在Android P最终版本发布之前，可以向Google发邮件申请，进行评估。<a href="https://issuetracker.google.com/issues/new?component=328403&amp;template=1027267" target="_blank" rel="noopener">地址</a><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180703153058913695268.png" alt="20180703153058913695268.png"></p>
<h3 id="如何修改使用到的非SDK接口"><a href="#如何修改使用到的非SDK接口" class="headerlink" title="如何修改使用到的非SDK接口"></a>如何修改使用到的非SDK接口</h3><p>Google提供的 Veridex 扫描工具，可以扫描apk中使用的API。</p>
<p><a href="https://android.googlesource.com/platform/prebuilts/runtime/+/master/appcompat/" target="_blank" rel="noopener">Veridex下载地址</a></p>
<p><a href="https://android.googlesource.com/platform/prebuilts/runtime/+/master/appcompat/README.txt" target="_blank" rel="noopener">Veridex使用方法</a></p>
<p>解压下载的Veridex压缩包，Terminal进入到解压后的目录，将要进行扫描的APK拷贝到解压后的目录中，执行命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./appcompat.sh --dex-file=test.apk</span><br></pre></td></tr></table></figure>
<p>扫描完成后，就可以看到扫描之后的结果，这里扫描到了98个非SDK API的调用，下面就要针对扫描出来的各个API进行调整了。开发者需要重点关注深灰名单及黑名单中的接口。<br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180703153059903252234.png" alt="20180703153059903252234.png"></p>
<h2 id="如何下载Android源码"><a href="#如何下载Android源码" class="headerlink" title="如何下载Android源码"></a>如何下载Android源码</h2><p>这里介绍一下Android Framework源码的下载，这里提供两个下载地址，下载之前可能需要准备好梯子，关于如何优雅的翻墙，可以看之前分享的一篇文章<a href="http://sguotao.top/读书笔记-2018-06-29-如何优雅的飞跃长城.html" target="_blank" rel="noopener">如何优雅的飞跃长城</a></p>
<p><a href="https://github.com/android/platform_frameworks_base" target="_blank" rel="noopener">github下载地址</a><br><a href="https://android.googlesource.com/platform/frameworks/base/" target="_blank" rel="noopener">Google官方下载地址</a></p>
<p>这里使用git的方式下载，方便后面更新。<br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068451557786.png" alt="20180704153068451557786.png"></p>
<h2 id="如何查看Android源码"><a href="#如何查看Android源码" class="headerlink" title="如何查看Android源码"></a>如何查看Android源码</h2><p>在Windows平台，有一个看源码的神器SourceInsight，但是在Mac平台还没有替代产品，这里介绍使用Sublime Text。打开Sublime Text。</p>
<p>File –&gt; open 定位到源码下载的目录，就可以方面的查看源码了。<br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068772575884.png" alt="20180704153068772575884.png"></p>
<p>在查看源码时，有时需要能够直接进行跳转，这时需要安装CTags插件。</p>
<p><strong>1. 在Sublime Text中，Preferences –&gt; Package Control</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068856974079.png" alt="20180704153068856974079.png"></p>
<p><strong>2.在弹出的Package Control窗口中选择Install Package，选择CTags插件进行安装</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068870646902.png" alt="20180704153068870646902.png"></p>
<p><strong>3.在CTags插件中添加跳转方式，Preferences –&gt;Package Settings –&gt; CTags –&gt; Mouse Bindings-Default</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068884216372.png" alt="20180704153068884216372.png"></p>
<p><strong>4. 拷贝出里边的配置文件</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068894421498.png" alt="20180704153068894421498.png"></p>
<p><strong>5. 复制到Preferences –&gt;Package Settings –&gt; CTags –&gt; Mouse Bindings-User中</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068898237535.png" alt="20180704153068898237535.png"></p>
<p><strong>6.在Sublime Text中打开文件的根目录右键–&gt; CTags:Rebuild Tags,让我们设置的跳转方式生效</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068900113818.png" alt="20180704153068900113818.png"></p>
<h2 id="遇到的问题及处理办法"><a href="#遇到的问题及处理办法" class="headerlink" title="遇到的问题及处理办法"></a>遇到的问题及处理办法</h2><p><strong>1.下载源码过程中遇到 error: RPC failed; curl 56 SSLRead() return error -9806835.00 KiB/s</strong><br>引起的原因多数与网络环境有关，解决办法，如果使用git下载，建议更换到SSH key的方式进行下载。</p>
<p><strong>2.使用Sublime Text插件CTags时，遇到错误提示</strong><br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068850714232.png" alt="20180704153068850714232.png"></p>
<p>遇到这个问题，多数是由于CTags插件版本引起的，进入Terminal，重新下载安装CTags插件。<br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068953579156.png" alt="20180704153068953579156.png"></p>
<p>安装完成后，查看CTags的安装目录，这里是<strong><em>/usr/local/bin</em></strong>,定位到我们下载好的Android源码的根目录，执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/ctags -R -f .tags</span><br></pre></td></tr></table></figure>
<p>待编译完成，生成.tags文件后，就可以在看代码时，使用快捷键进行跳转了。<br><img src="http://7u2np3.com1.z0.glb.clouddn.com/20180704153068964449010.png" alt="20180704153068964449010.png"></p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a href="https://testerhome.com/topics/13699" target="_blank" rel="noopener">https://testerhome.com/topics/13699</a></li>
<li><a href="https://developer.android.google.cn/reference/packages" target="_blank" rel="noopener">https://developer.android.google.cn/reference/packages</a></li>
</ol>
<hr>
<p>本文链接：<a href="http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html">http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    
      <div>
        
          
<div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center">
  <div>「真诚赞赏，手留余香」</div>
  <button id="rewardButton", disable="enable", onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}", style="cursor: pointer; border: 0; outline: 0; border-radius: 100%; padding: 0; margin: 0; letter-spacing: normal; text-transform: none; text-indent: 0px; text-shadow: none">
    <span onmouseover="this.style.color='rgb(236,96,0)';this.style.background='rgb(204,204,204)'" onMouseOut="this.style.color='#fff';this.style.background='rgb(236,96,0)'" style="display: inline-block; width: 70px; height: 70px; border-radius: 100%; line-height: 81px; color: #fff; font: 400 35px/75px 'microsofty'; background: rgb(236,96,0)">赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechat_pay.png" alt="Scott WeChat Pay" style="width: 200px; max-width: 100%; display: inline-block"/>
        <p>微信打赏</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alibaba_pay.png" alt="Scott Alipay" style="width: 200px; max-width: 100%; display: inline-block"/>
        <p>支付宝打赏</p>
      </div>
    

    

  </div>
</div>

        
      </div>
    

    <div>
      
        
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>本文作者：</strong>
      Scott
    </li>
    <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html" title="如何下载并查看Android源码">http://www.sguotao.top/Android进阶-2018-07-03-如何下载并查看Android源码.html</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明： </strong>
      本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
    </li>
  </ul>


      
    </div>

    <div>
      
        
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8474352740015305",
    enable_page_level_ads: true
  });
</script>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag"><i class="fa fa-tag"></i> Android</a>
          
            <a href="/tags/源码/" rel="tag"><i class="fa fa-tag"></i> 源码</a>
          
            <a href="/tags/Google/" rel="tag"><i class="fa fa-tag"></i> Google</a>
          
            <a href="/tags/Github/" rel="tag"><i class="fa fa-tag"></i> Github</a>
          
            <a href="/tags/Framework/" rel="tag"><i class="fa fa-tag"></i> Framework</a>
          
            <a href="/tags/SDK限制/" rel="tag"><i class="fa fa-tag"></i> SDK限制</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/读书笔记-2018-06-29-如何优雅的飞跃长城.html" rel="next" title="如何优雅的飞跃长城">
                <i class="fa fa-chevron-left"></i> 如何优雅的飞跃长城
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Android进阶-2018-07-11-android-gradle-v3-0新特性的介绍.html" rel="prev" title="Android Gradle v3.0新特性介绍">
                Android Gradle v3.0新特性介绍 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8yODkyOC81NDk3"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="Scott" />
          <p class="site-author-name" itemprop="name">Scott</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">92</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">64</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#引言"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android-P中SDK接口限制"><span class="nav-number">2.</span> <span class="nav-text">Android P中SDK接口限制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是SDK接口"><span class="nav-number">2.1.</span> <span class="nav-text">什么是SDK接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#继续使用非SDK接口会有哪些影响"><span class="nav-number">2.2.</span> <span class="nav-text">继续使用非SDK接口会有哪些影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何修改使用到的非SDK接口"><span class="nav-number">2.3.</span> <span class="nav-text">如何修改使用到的非SDK接口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何下载Android源码"><span class="nav-number">3.</span> <span class="nav-text">如何下载Android源码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何查看Android源码"><span class="nav-number">4.</span> <span class="nav-text">如何查看Android源码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#遇到的问题及处理办法"><span class="nav-number">5.</span> <span class="nav-text">遇到的问题及处理办法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考文献"><span class="nav-number">6.</span> <span class="nav-text">参考文献</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Scott</span>
  <span class="with-love">
    <i class="fa fa-pencil"></i>
  </span>
  <span class="post-count">共写了200.1k字</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (search_path.endsWith("json")) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("iH9ug4Eu98bS8XiH30QEwODs-gzGzoHsz", "D0qgHUsqtcQOClhgS4ElkmDQ");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script>


  

</body>
</html>
